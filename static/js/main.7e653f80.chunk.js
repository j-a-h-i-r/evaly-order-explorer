(this["webpackJsonpevaly-orders"]=this["webpackJsonpevaly-orders"]||[]).push([[0],{20:function(e,t,r){},21:function(e,t,r){},31:function(e,t,r){"use strict";r.r(t);var n=r(0),s=r.n(n),o=r(3),a=r.n(o),i=(r(20),r(21),r(4)),c=r.n(i),l=r(5),d=r(13),u=r(6),b=r.n(u),f=r(14),p=r.n(f),h=r(11),j=r.n(h),m=r(1);var x={plotOptions:{bar:{horizontal:!0,distributed:!0,dataLabels:{hideOverflowingLabels:!1,position:"top"}}},dataLabels:{enabled:!0,offsetX:60,textAnchor:"start",formatter:function(e,t){var r=b()(e[0]),n=b()(e[1]).diff(r,"d");return n+(n>1?" days":" day")},background:{dropShadow:{enabled:!1},opacity:1,enabled:!0,foreColor:"#fd5f77",borderColor:"#ff7dff",padding:6},style:{colors:["#f3f4f5","#fff"]}},xaxis:{type:"datetime"},grid:{row:{colors:["#f3f4f5","#fff"],opacity:1}}};function v(e){var t=e.orderDeliveryDates,r=[{data:t.map((function(e){return{x:e.invoice_no,y:[e.orderDate,e.deliveryDate]}}))}];return console.log("Series",r),Object(m.jsx)(j.a,{series:r,options:x,type:"rangeBar"})}var g=r(2),O=r.n(g),y=r(9),w="https://card-cors.herokuapp.com/",N="https://api.evaly.com.bd/core/custom/orders/",k="https://api.evaly.com.bd/core/orders/histories/";function D(e,t){return C.apply(this,arguments)}function C(){return(C=Object(y.a)(O.a.mark((function e(t,r){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w+r,{headers:{Authorization:"Bearer "+t}});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return A.apply(this,arguments)}function A(){return(A=Object(y.a)(O.a.mark((function e(t){var r,n,s,o,a,i,c=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:"1",console.log("pageNum",r),n=N+"?page=".concat(r),console.log("url",n),e.next=6,D(t,n);case 6:if(s=e.sent,o=s.results,console.log("response",s),!s.next){e.next=18;break}if(!(i=null===(a=/page=(\d+)/.exec(s.next))||void 0===a?void 0:a[1])){e.next=15;break}return e.abrupt("return",S(t,i).then((function(e){return o.concat(e)})).catch((function(){return o})));case 15:return e.abrupt("return",o);case 16:e.next=19;break;case 18:return e.abrupt("return",o);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return T.apply(this,arguments)}function T(){return(T=Object(y.a)(O.a.mark((function e(t,r){var n,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=k+r+"/",e.next=3,fetch(w+n,{headers:{Authorization:"Bearer "+t}});case 3:return s=e.sent,e.abrupt("return",s.json());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(y.a)(O.a.mark((function e(t,r){var n,s,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.map((function(e){return e.invoice_no})),e.next=3,Promise.all(n.map((function(e){return _(t,e)})));case 3:return s=e.sent,o=s.map((function(e){return e.data})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E={plotOptions:{bar:{distributed:!0}},grid:{row:{colors:["#f3f4f5","#fff"],opacity:1}}};function L(e){var t=function(e){var t={};return e.forEach((function(e){var r=e.order_status;t[r]?t[r]+=1:t[r]=1})),[{data:Object.entries(t).map((function(e){var t=Object(l.a)(e,2);return{x:t[0],y:t[1]}}))}]}(e.orders);return Object(m.jsx)(j.a,{series:t,options:E,type:"bar",height:300})}function P(e){var t=e.header,r=e.content;return Object(m.jsxs)("p",{className:"bg-indigo-200 font-medium px-3 py-1 rounded-full",children:[t,Object(m.jsx)("span",{className:"bg-pink-400 font-bold ml-2 px-3 rounded-full text-white",children:r})]})}var B=r.p+"static/media/github.3b21c250.svg";var I="document.cookie.split('; ').find((x) => x.startsWith('token=')).split('=')[1]";function M(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),r=t[0],s=t[1],o=Object(n.useState)([]),a=Object(l.a)(o,2),u=a[0],f=a[1],h=Object(n.useState)([]),j=Object(l.a)(h,2),x=j[0],g=j[1],O=Object(n.useState)([]),y=Object(l.a)(O,2),w=y[0],N=y[1],k=Object(n.useState)([]),D=Object(l.a)(k,2),C=D[0],A=D[1],_=Object(i.useNotifications)(),T=_.notify,E=_.notifications,M=_.dismissNotification;Object(n.useEffect)((function(){r&&(T({message:"Fetching order detail data. Wait a while",status:"loading",id:"order-detail-loading",dismissAfter:0}),function(e,t){return F.apply(this,arguments)}(r,u).then((function(e){g(e),M("order-detail-loading"),T({message:"Order detail fetch complete.",status:"success"});var t=e.filter((function(e){return"delivered"===e.order_status})).map((function(e){var t,r,n=e.invoice_no,s=e.histories,o=null===(t=s.find((function(e){return"pending"===e.order_status})))||void 0===t?void 0:t.date,a=null===(r=s.find((function(e){return"delivered"===e.order_status})))||void 0===r?void 0:r.date;return{invoice_no:n,orderDate:b()(o).valueOf(),deliveryDate:b()(a).valueOf()}}));N(t),A(function(e){var t=Object(d.a)(e).sort((function(e,t){return e.orderDate-t.orderDate})).map((function(e){var t=e.orderDate,r=e.deliveryDate;return b()(r).diff(t,"d")})),r=Object(d.a)(t).sort((function(e,t){return e-t})),n=r.reduce((function(e,t){return e+t}),0)/r.length,s=r[0],o=r[r.length-1];return{average:Math.round(100*n)/100,minimum:s,maximum:o}}(t))})).catch((function(e){console.error(e),T({message:"Error while fetching order details",status:"error"})})))}),[u]);return console.log("deliver",x),console.log("deliver",w),Object(m.jsxs)("div",{className:"pb-4",children:[Object(m.jsxs)("div",{className:"container mx-auto px-4 text-center",children:[Object(m.jsxs)("div",{className:"relative",children:[Object(m.jsx)("p",{className:"text-4xl font-bold ",children:"View your order history"}),Object(m.jsx)("div",{className:"absolute top-1 right-0",children:Object(m.jsx)("a",{href:"https://github.com/j-a-h-i-r/evaly-order-explorer",className:"ml-auto",target:"_blank",rel:"noreferrer",children:Object(m.jsx)("img",{src:B,width:32,alt:"GitHub repository Url",className:"ml-auto"})})})]}),Object(m.jsxs)("div",{className:"bg-blue-100 bg-opacity-10 mt-5 p-4 ring-2 rounded text-left",children:[Object(m.jsx)("p",{className:"font-bold",children:"How to use?"}),Object(m.jsx)("p",{children:"An access token is required to fetch your Evaly orders. The easiest way to get it is as follows"}),Object(m.jsxs)("ol",{className:"list-decimal list-inside",children:[Object(m.jsx)("li",{children:"Login at evaly.com.bd"}),Object(m.jsxs)("li",{children:["Open console panel and paste the following (click to copy), ",Object(m.jsx)("br",{}),Object(m.jsx)("p",{onClick:function(){p()(I),T({message:"Code copied to clipboard",status:"success"})},className:"bg-purple-100 inline-block py-2 px-4 rounded font-mono",children:I})]}),Object(m.jsx)("li",{children:"Copy the output and paste in the below input box"})]})]}),Object(m.jsxs)("div",{className:"bg-yellow-100 mt-5 p-4 ring-2 rounded text-left ring-yellow-300",children:[Object(m.jsx)("p",{className:"font-bold",children:"Warning"}),Object(m.jsx)("p",{children:" Access token is sensitive information. Do not share it with anyone. This web app requires the access token as I have not found any other way of fetching order data without the access token."}),Object(m.jsx)("p",{children:" This web app runs entirely on your browser. The only external service being used is a proxy server. It is required to bypass the CORS policy. "})]}),Object(m.jsxs)("div",{className:"mt-10",children:[Object(m.jsx)("input",{className:"border-2 p-2 rounded w-2/4 border-blue-300",placeholder:"Paste token",type:"text",value:r,onChange:function(e){return s(e.target.value)}}),Object(m.jsx)("button",{type:"button",className:"border-2 ml-2 p-2 px-4 rounded bg-blue-200 border-blue-300 font-bold",onClick:function(){console.log(r),r&&(T({message:"Fetching order status. Wait a while",status:"loading",id:"order-loading",dismissAfter:0}),S(r).then((function(e){console.log(e),f(e),M("order-loading"),T({message:"Order status fetch complete",status:"success"})})).catch((function(e){console.log(e),T({message:"Error while fetching order status",status:"error"})})))},children:"Fetch"})]}),Object(m.jsxs)("div",{className:"border-2 border-blue-100 mt-10 rounded",children:[Object(m.jsx)("p",{className:"font-bold text-lg bg-blue-100 py-1",children:" Order Status "}),Object(m.jsx)("div",{className:"py-4",children:Object(m.jsx)(L,{orders:u})})]}),Object(m.jsxs)("div",{className:"border-2 border-blue-100 mt-10 rounded",children:[Object(m.jsx)("p",{className:"font-bold text-lg bg-blue-100 py-1",children:"Order Timeline"}),Object(m.jsxs)("div",{className:"py-4",children:[Object(m.jsx)(v,{orderDeliveryDates:w}),Object(m.jsxs)("p",{className:"bg-blue-50 font-semibold inline-block px-6 py-2 rounded-full text-left",children:["You have total ",Object(m.jsx)("span",{className:"bg-blue-300 font-bold px-2 rounded-full",children:u.length})," orders. Out of these, ",Object(m.jsx)("span",{className:"bg-blue-300 font-bold px-2 rounded-full",children:w.length})," has been delivered."]}),Object(m.jsxs)("div",{className:"flex justify-evenly mt-5",children:[Object(m.jsx)(P,{header:"Minimum",content:C.minimum}),Object(m.jsx)(P,{header:"Average",content:C.average}),Object(m.jsx)(P,{header:"Maximum",content:C.maximum})]})]})]})]}),Object(m.jsx)(c.a,{theme:i.atalhoTheme,notifications:E,dismissNotification:function(e){return M(e)}})]})}Object(i.setUpNotifications)({defaultProps:{position:"top-right",dismissible:!0,dismissAfter:5e3}});var W=function(){return Object(m.jsx)(i.NotificationsProvider,{children:Object(m.jsx)(M,{})})},q=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,32)).then((function(t){var r=t.getCLS,n=t.getFID,s=t.getFCP,o=t.getLCP,a=t.getTTFB;r(e),n(e),s(e),o(e),a(e)}))};a.a.render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(W,{})}),document.getElementById("root")),q()}},[[31,1,2]]]);
//# sourceMappingURL=main.7e653f80.chunk.js.map